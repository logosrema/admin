var el = document.querySelector(".chrome-tabs");
var chromeTabs = new ChromeTabs();
chromeTabs.init(el);
$(".home").show();
TabArray = [];
TabMap = new Map();
let contentEl;

el.addEventListener("activeTabChange", ({ detail }) =>
  onTabChanged(detail.tabEl)
);
el.addEventListener("tabAdd", ({ detail }) =>
  addTabStyle(contentEl, detail.tabEl)
);
el.addEventListener("tabRemove", ({ detail }) => closeTab(detail.tabEl));

function addTabStyle(contentEl, elem) {
  TabMap.set(contentEl, elem);
  $(".chrome-tab-drag-handle").removeClass("chromclass");
  $(elem).find(".chrome-tab-drag-handle").addClass("chromclass");
}

function closeTab(elem) {
  let tabName = $(elem).find(".chrome-tab-holder").text().trim();
  TabArray = TabArray.filter((item) => item !== tabName);
  console.log(TabArray);
}

function onTabChanged(elem) {
  let tabContent = $(elem).find(".chrome-tab-holder").text().trim();
  $(".chrome-tab-drag-handle").removeClass("chromclass");
  $(elem).find(".chrome-tab-drag-handle").addClass("chromclass");
  $(".chrome__tab").hide();
  $("." + tabContent).show();
}

function addnewTab(tabName, tabContent) {
  if (TabArray.includes(tabContent)) {
    $(".chrome__tab").hide();
    $("." + tabContent).show();
    $(".chrome-tab").removeClass("active");
    chromeTabs.setCurrentTab(TabMap.get(tabContent));
    return;
  } else {
    contentEl = tabContent;
    chromeTabs.addTab({
      title: tabName,
      favicon: false,
      content: tabContent,
    });
    $(".chrome__tab").hide();
    $("." + tabContent).show();
    TabArray.push(tabContent);
    console.log(TabArray);
  }
}

$(".tab-button").click(function () {
    addnewTab($(this).text().trim(), $(this).attr("value"));
});

// the scroll fn
function scrollTable(direction) {
  const tableWrapper = document.querySelector(".table-wrapper");
  const scrollAmount = 500; // Adjust
  tableWrapper.scrollBy({
    left: direction === 'left' ? -scrollAmount : scrollAmount,
    behavior: 'smooth'
  });
}
